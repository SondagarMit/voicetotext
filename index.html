<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Translator</title>
</head>
<body>
    <h1>Voice Translator</h1>

    <!-- Language Selection -->
    <label for="default-lang">Default Language:</label>
    <select id="default-lang">
        <option value="gu" selected>Gujarati</option>
        <option value="en">English</option>
        <option value="hi">Hindi</option>
        <option value="es">Spanish</option>
        <option value="fr">French</option>
    </select>

    <label for="translate-lang">Translate To:</label>
    <select id="translate-lang">
        <option value="en" selected>English</option>
        <option value="hi">Hindi</option>
        <option value="es">Spanish</option>
        <option value="fr">French</option>
    </select>

    <!-- Voice Recording Button -->
    <button onclick="startVoiceRecording()">Record Voice</button>
    <p><b>Original Voice to Text:</b> <span id="original-text"></span></p>
    <p><b>Translated Text:</b> <span id="translated-text"></span></p>

    <script>
        // Start voice recording and handle transcription
        async function startVoiceRecording() {
            // Show recording message
            alert("Recording started. Speak now...");
            try {
                // Use Web Speech API for voice recognition
                const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
                recognition.lang = document.getElementById("default-lang").value;
                recognition.start();

                recognition.onresult = async (event) => {
                    const originalText = event.results[0][0].transcript; // Get recognized text
                    document.getElementById("original-text").textContent = originalText; // Display original text

                    // Translate text
                    await translateText(originalText);
                };

                recognition.onerror = (event) => {
                    console.error("Speech recognition error:", event.error);
                    alert("Failed to recognize voice. Please try again.");
                };
            } catch (error) {
                console.error("Voice recording error:", error);
                alert("Your browser doesn't support voice recording.");
            }
        }

        // Translate text
        async function translateText(originalText) {
            const defaultLang = document.getElementById("default-lang").value;
            const translateLang = document.getElementById("translate-lang").value;

            // Encode the text for the URL
            const encodedText = encodeURIComponent(originalText);

            try {
                const response = await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=${defaultLang}&tl=${translateLang}&dt=t&q=${encodedText}`);
                const result = await response.json();

                // Extract and display the translated text
                const translatedText = result[0][0][0];
                document.getElementById("translated-text").textContent = translatedText;
            } catch (error) {
                console.error("Translation error:", error);
                document.getElementById("translated-text").textContent = "Translation failed.";
            }
        }
    </script>
</body>
</html>
